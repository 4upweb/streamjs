/*! Stream.js 2015-01-10 */

(function(){"use strict";var a=this,b="0.4.1",c={},d={},e={},f=function(a){var b,f=this;b=l(a)?new g(function(){return a.call(c)}):new h(function(a){return a},!0,a),this.add=function(a){if(null!==b){var c=b;a.prev=c,c.next=a}b=a},this.next=function(){return b.advance()},this.filter=function(a){return this.add(new h(function(b){var d=a.call(c,b);return d?b:e})),this},this.map=function(a){return this.add(new h(function(b){return a.call(c,b)})),this},this.flatMap=function(a){return this.add(new h(function(b){return a.call(c,b)},!0)),this},this.sorted=function(a){return this.add(new i({finisher:function(b){b.sort(a)}})),this},this.skip=function(a){return this.add(new i({filter:function(b,c){return c>=a}})),this},this.limit=function(a){return this.add(new i({voter:function(b,c){return a>c}})),this},this.peek=function(a){return this.add(new i({consumer:a})),this},this.distinct=function(){return this.add(new i({filter:function(a,b,c){return c.indexOf(a)<0}})),this};var n={};n.toArray=function(){for(var a,b=[];(a=f.next())!==d;)b.push(a);return b},n.findFirst=function(){var a=f.next();return a===d?j.empty():j.ofNullable(a)},n.forEach=function(a){for(var b;(b=f.next())!==d;)a.call(c,b)},n.min=function(a){a=a||k;for(var b,e=null;(b=f.next())!==d;)(null===e||a.call(c,b,e)<0)&&(e=b);return j.ofNullable(e)},n.max=function(a){a=a||k;for(var b,e=null;(b=f.next())!==d;)(null===e||a.call(c,b,e)>0)&&(e=b);return j.ofNullable(e)},n.sum=function(){for(var a,b=0;(a=f.next())!==d;)b+=a;return b},n.average=function(){for(var a,b=0,c=0;(a=f.next())!==d;)c+=a,b++;return 0===c||0===b?j.empty():j.of(c/b)},n.count=function(){for(var a,b=0;(a=f.next())!==d;)b++;return b},n.allMatch=function(a){for(var b;(b=f.next())!==d;){var e=a.call(c,b);if(!e)return!1}return!0},n.anyMatch=function(a){for(var b;(b=f.next())!==d;){var e=a.call(c,b);if(e)return!0}return!1},n.noneMatch=function(a){for(var b;(b=f.next())!==d;){var e=a.call(c,b);if(e)return!1}return!0},n.collect=function(a){for(var b,e=a.supplier.call(c),g=!0;(b=f.next())!==d;)e=a.accumulator.call(c,e,b,g),g=!1;return a.finisher&&(e=a.finisher.call(c,e)),e},n.reduce=function(){var a=arguments[0],b=arguments[1];return b?f.collect({supplier:function(){return a},accumulator:b}):o(a)};var o=function(a){var b,e=f.next();if(e===d)return j.empty();for(;(b=f.next())!==d;)e=a.call(c,e,b);return j.ofNullable(e)};n.groupBy=function(a){return f.collect({supplier:function(){return{}},accumulator:function(b,d){var e=a.call(c,d);return b.hasOwnProperty(e)||(b[e]=[]),void 0===b[e]&&(b[e]=[]),b[e].push(d),b}})},n.toMap=function(a,b){return f.collect({supplier:function(){return{}},accumulator:function(d,e){var f=a.call(c,e);if(d.hasOwnProperty(f)){if(!b)throw"duplicate mapping found for key: "+f;return d[f]=b.call(c,d[f],e),d}return d[f]=e,d}})},n.partitionBy=function(){var a=arguments[0];if(l(a))return p(a);if(m(a))return q(a);throw"partitionBy requires argument of type function or number"};var p=function(a){return f.collect({supplier:function(){return{}},accumulator:function(b,d){var e=a.call(c,d);return b.hasOwnProperty(e)||(b[e]=[]),b[e].push(d),b}})},q=function(a){return f.collect({supplier:function(){return[]},accumulator:function(b,c){if(0===b.length)return b.push([c]),b;var d=b[b.length-1];return d.length===a?(b.push([c]),b):(d.push(c),b)}})};n.joining=function(a){var b="",c="",d="";return a&&(b=a.prefix||b,c=a.suffix||c,d=a.delimiter||d),f.collect({supplier:function(){return""},accumulator:function(a,b,c){var e=c?"":d;return a+e+String(b)},finisher:function(a){return b+a+c}})};var r=!1,s=function(a){return function(){try{if(r)throw"stream has already been operated upon";return a.apply(f,arguments)}finally{r=!0}}};for(var t in n)n.hasOwnProperty(t)&&(this[t]=s(n[t]));this.indexBy=this.toMap,this.partitioningBy=this.partitionBy,this.groupingBy=this.groupBy,this.each=this.forEach,this.toList=this.toArray,this.join=this.joining,this.avg=this.average,this.sort=this.sorted,this.size=this.count,this.findAny=this.findFirst};f.prototype.toString=function(){return"[object Stream]"};var g=function(a){this.prev=null,this.next=null,this.advance=function(){var b=a.call(c);return this.next.pipe(b)}},h=function(a,b,f){this.prev=null,this.next=null,this.advance=function(){if(!l()&&null===this.prev)return d;if(!l())return this.prev.advance();var a=m();return null!==this.next?this.next.pipe(a):a},this.pipe=function(d){var e=a.call(c,d);return q(e,b),l()?(d=m(),null!==this.next?this.next.pipe(d):d):this.advance()};var g=e,h=!1,i=e,j=0,k=0,l=function(){return g===e?!1:h?k>j:!0},m=function(){var a;return h?(a=p(),j++,j>=k&&(g=e,i=e,h=!1,j=0,k=0),a):(a=g,g=e,a)},p=function(){if(n(g))return g[j];var a=i[j];return g[a]},q=function(a,b){g=a,b&&(n(g)?(k=g.length,h=b):o(g)?(i=Object.keys(g),k=i.length,h=b):h=!1)};f&&q(f,b)},i=function(a){this.prev=null,this.next=null;var b=null,e=0;this.advance=function(){var f;if(null===b){for(b=[];(f=this.prev.advance())!==d;)if(e++,a.voter){var g=a.voter.call(c,f,e);if(!g)break}a.finisher&&a.finisher.call(c,b)}return 0===b.length?d:(f=b.shift(),null!==this.next?this.next.pipe(f):f)},this.pipe=function(d){a.consumer&&a.consumer.call(c,d,e);var f=!0;a.filter&&(f=a.filter.call(c,d,e,b)),f&&b.push(d)}},j=function(a){this.isPresent=function(){return null!==a&&void 0!==a},this.get=function(){if(!this.isPresent())throw"optional value is not present";return a},this.ifPresent=function(b){this.isPresent()&&b.call(a,a)},this.orElse=function(b){return this.isPresent()?a:b},this.orElseGet=function(b){return this.isPresent()?a:b.call(c)},this.orElseThrow=function(b){if(this.isPresent())return a;throw b},this.filter=function(b){if(this.isPresent()){var d=b.call(c,a);return d?this:j.empty()}return this},this.map=function(b){if(this.isPresent()){var d=b.call(c,a);return j.ofNullable(d)}return this},this.flatMap=function(b){return this.isPresent()?b.call(c,a):this}};j.prototype.toString=function(){return"[object Optional]"},j.of=function(a){if(null===a||void 0===a)throw"value must be present";return new j(a)},j.ofNullable=function(a){return new j(a)},j.empty=function(){return new j(void 0)};var k=function(a,b){return a===b?0:a>b?1:-1},l=function(a){return"function"==typeof a||!1},m=function(a){return"[object Number]"===Object.prototype.toString.call(a)},n=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},o=function(a){return"object"==typeof a&&!!a},p=function(a){return new f(a)};p.range=function(a,b){for(var c=[],d=a;b>d;d++)c.push(d);return p(c)},p.rangeClosed=function(a,b){return p.range(a,b+1)},p.of=function(){var a=Array.prototype.slice.call(arguments);return p(a)},p.generate=function(a){return p(a)},p.iterate=function(a,b){var d=!0,e=a;return p(function(){return d?(d=!1,a):e=b.call(c,e)})},p.VERSION=b,p.Optional=j;var q=window.Stream;p.noConflict=function(){return window.Stream=q,p},"undefined"!=typeof module&&module.exports?module.exports=p:"function"==typeof define&&define.amd?define("streamjs",[],function(){return p}):a.Stream=p}).call(this);
//# sourceMappingURL=stream.min.js.map