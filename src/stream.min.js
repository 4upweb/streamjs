/*! Stream.js 2015-01-09 */

(function(){"use strict";var a=this,b="0.4.0",c=function(a){var b,c=this;b=l(a)?new d(function(){return a.call(i)}):new e(function(a){return a},!0,a),this.add=function(a){if(null!==b){var c=b;a.prev=c,c.next=a}b=a},this.next=function(){return b.advance()},this.filter=function(a){return k(a,"predicate function argument required for filter"),this.add(new e(function(b){var c=a.call(i,b);return c?b:null})),this},this.map=function(a){return k(a,"mapper function argument required for map"),this.add(new e(function(b){return a.call(i,b)})),this},this.flatMap=function(a){return k(a,"mapper function argument required for flatMap"),this.add(new e(function(b){return a.call(i,b)},!0)),this},this.sorted=function(a){return this.add(new f({finisher:function(b){b.sort(a)}})),this},this.skip=function(a){return this.add(new f({filter:function(b,c){return c>=a}})),this},this.limit=function(a){return this.add(new f({voter:function(b,c){return a>c}})),this},this.peek=function(a){return this.add(new f({consumer:a})),this},this.distinct=function(){return this.add(new f({filter:function(a,b,c){return c.indexOf(a)<0}})),this};var n={};n.toArray=function(){for(var a,b=[];(a=c.next())!==h;)b.push(a);return b},n.findFirst=function(){var a=c.next();return a===h?g.empty():g.ofNullable(a)},n.forEach=function(a){for(var b;(b=c.next())!==h;)a.call(i,b)},n.min=function(a){a=a||j;for(var b,d=null;(b=c.next())!==h;)(null===d||a.call(i,b,d)<0)&&(d=b);return g.ofNullable(d)},n.max=function(a){a=a||j;for(var b,d=null;(b=c.next())!==h;)(null===d||a.call(i,b,d)>0)&&(d=b);return g.ofNullable(d)},n.sum=function(){for(var a,b=0;(a=c.next())!==h;)b+=a;return b},n.average=function(){for(var a,b=0,d=0;(a=c.next())!==h;)d+=a,b++;return 0===d||0===b?g.empty():g.of(d/b)},n.count=function(){for(var a,b=0;(a=c.next())!==h;)b++;return b},n.allMatch=function(a){for(var b;(b=c.next())!==h;){var d=a.call(i,b);if(!d)return!1}return!0},n.anyMatch=function(a){for(var b;(b=c.next())!==h;){var d=a.call(i,b);if(d)return!0}return!1},n.noneMatch=function(a){for(var b;(b=c.next())!==h;){var d=a.call(i,b);if(d)return!1}return!0},n.collect=function(a){for(var b,d=a.supplier.call(i),e=!0;(b=c.next())!==h;)d=a.accumulator.call(i,d,b,e),e=!1;return a.finisher&&(d=a.finisher.call(i,d)),d},n.reduce=function(){var a=arguments[0],b=arguments[1];return b?c.collect({supplier:function(){return a},accumulator:b}):o(a)};var o=function(a){var b,d=c.next();if(d===h)return g.empty();for(;(b=c.next())!==h;)d=a.call(i,d,b);return g.ofNullable(d)};n.groupBy=function(a){return c.collect({supplier:function(){return{}},accumulator:function(b,c){var d=a.call(i,c);return b.hasOwnProperty(d)||(b[d]=[]),void 0===b[d]&&(b[d]=[]),b[d].push(c),b}})},n.toMap=function(a,b){return c.collect({supplier:function(){return{}},accumulator:function(c,d){var e=a.call(i,d);if(c.hasOwnProperty(e)){if(!b)throw"duplicate mapping found for key: "+e;return c[e]=b.call(i,c[e],d),c}return c[e]=d,c}})},n.partitionBy=function(){var a=arguments[0];if(l(a))return p(a);if(m(a))return q(a);throw"partitionBy requires argument of type function or number"};var p=function(a){return c.collect({supplier:function(){return{}},accumulator:function(b,c){var d=a.call(i,c);return b.hasOwnProperty(d)||(b[d]=[]),b[d].push(c),b}})},q=function(a){return c.collect({supplier:function(){return[]},accumulator:function(b,c){if(0===b.length)return b.push([c]),b;var d=b[b.length-1];return d.length===a?(b.push([c]),b):(d.push(c),b)}})};n.joining=function(a){var b="",d="",e="";return a&&(b=a.prefix||b,d=a.suffix||d,e=a.delimiter||e),c.collect({supplier:function(){return""},accumulator:function(a,b,c){var d=c?"":e;return a+d+String(b)},finisher:function(a){return b+a+d}})};var r=!1,s=function(a){return function(){try{if(r)throw"stream has already been operated upon";return a.apply(c,arguments)}finally{r=!0}}};for(var t in n)n.hasOwnProperty(t)&&(this[t]=s(n[t]));this.indexBy=this.toMap,this.partitioningBy=this.partitionBy,this.groupingBy=this.groupBy,this.each=this.forEach,this.toList=this.toArray,this.join=this.joining,this.avg=this.average,this.sort=this.sorted,this.size=this.count,this.findAny=this.findFirst};c.prototype.toString=function(){return"[object Stream]"};var d=function(a){this.prev=null,this.next=null,this.advance=function(){var b=a.call(i);return this.next.pipe(b)}},e=function(a,b,c){this.prev=null,this.next=null,this.advance=function(){if(!k()&&null===this.prev)return h;if(!k())return this.prev.advance();var a=l();return null!==this.next?this.next.pipe(a):a},this.pipe=function(c){var d=a.call(i,c);return p(d,b),k()?(c=l(),null!==this.next?this.next.pipe(c):c):this.advance()};var d=null,e=!1,f=null,g=0,j=0,k=function(){return null===d?!1:e?j>g:!0},l=function(){var a;return e?(a=m(),g++,g>=j&&(d=null,f=null,e=!1,g=0,j=0),a):(a=d,d=null,a)},m=function(){if(n(d))return d[g];var a=f[g];return d[a]},p=function(a,b){d=a,e=b,e&&(n(d)?j=d.length:o(d)&&(f=Object.keys(d),j=f.length))};c&&p(c,b)},f=function(a){this.prev=null,this.next=null;var b=null,c=0;this.advance=function(){var d;if(null===b){for(b=[];(d=this.prev.advance())!==h;)if(c++,a.voter){var e=a.voter.call(i,d,c);if(!e)break}a.finisher&&a.finisher.call(i,b)}return 0===b.length?h:(d=b.shift(),null!==this.next?this.next.pipe(d):d)},this.pipe=function(d){a.consumer&&a.consumer.call(i,d,c);var e=!0;a.filter&&(e=a.filter.call(i,d,c,b)),e&&b.push(d)}},g=function(a){this.isPresent=function(){return null!==a&&void 0!==a},this.get=function(){if(!this.isPresent())throw"optional value is not present";return a},this.ifPresent=function(b){this.isPresent()&&b.call(a,a)},this.orElse=function(b){return this.isPresent()?a:b},this.orElseGet=function(b){return this.isPresent()?a:b.call(i)},this.orElseThrow=function(b){if(this.isPresent())return a;throw b},this.filter=function(b){if(this.isPresent()){var c=b.call(i,a);return c?this:g.empty()}return this},this.map=function(b){if(this.isPresent()){var c=b.call(i,a);return g.ofNullable(c)}return this},this.flatMap=function(b){return this.isPresent()?b.call(i,a):this}};g.prototype.toString=function(){return"[object Optional]"},g.of=function(a){if(null===a||void 0===a)throw"value must be present";return new g(a)},g.ofNullable=function(a){return new g(a)},g.empty=function(){return new g(void 0)};var h="END_OF_PIPE",i={},j=function(a,b){return a===b?0:a>b?1:-1},k=function(a,b){if(!l(a))throw b},l=function(a){return"function"==typeof a||!1},m=function(a){return"[object Number]"===Object.prototype.toString.call(a)},n=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},o=function(a){return"object"==typeof a&&!!a},p=function(a){return new c(a)};p.range=function(a,b){for(var c=[],d=a;b>d;d++)c.push(d);return p(c)},p.rangeClosed=function(a,b){return p.range(a,b+1)},p.of=function(){var a=Array.prototype.slice.call(arguments);return p(a)},p.generate=function(a){return p(a)},p.iterate=function(a,b){var c=!0,d=a;return p(function(){return c?(c=!1,a):d=b.call(i,d)})},p.VERSION=b,p.Optional=g;var q=window.Stream;p.noConflict=function(){return window.Stream=q,p},"undefined"!=typeof module&&module.exports?module.exports=p:"function"==typeof define&&define.amd?define("streamjs",[],function(){return p}):a.Stream=p}).call(this);
//# sourceMappingURL=stream.min.js.map